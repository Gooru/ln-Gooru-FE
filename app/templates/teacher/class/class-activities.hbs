<div class="controller teacher class class-activities">
  <div class="ca-date-and-add-content">
    <div class="ca-add-content">
      <div class="ca-contents-button">
        <p>{{t 'common.plan-an-activities'}}</p>
        <i class="collection-icon" {{action 'onAddDca' 'collection'}}></i>
        <i class="assessment-icon" {{action 'onAddDca' 'assessment'}}></i>
      </div>
    </div>
    <div class="ca-date-selector">
      {{ca-date-picker
    showToday=true
    forMonth=forMonth
    allowDateSelectorToggle=true
    forYear=forYear
    refreshDatePicker=refreshDatePicker
    showPreviousMonth="showPreviousMonth"
    showNextMonth="showNextMonth"
    onSelectDate="onSelectDate"
    onSelectToday="onSelectDate"
    activities=scheduledClassActivitiesDatewise
    highlightActivities=true
  }}
    </div>
    <div class="ca-today" {{action 'onSelectToday'}}>{{t "student-landing.class.class-activities-tab.today"}}</div>
  </div>
  <div class="ca-panel">
    <div class="ca-left-panel">
      <div class="loading-spinner {{if isLoading 'active'}}">
        {{three-bounce-spinner}}
      </div>
      <div class="dca-content-container">
        <div class="ca-schedule-items-header">
          <span>{{t 'common.scheduled-items'}} ({{totalScheduleditems}})</span>
        </div>
        {{#if showClassActivities}}
          <div class="dca-list-container">
            {{#each scheduledClassActivities as |classActivity|}}
              <div class="dca-date-view-container dca-date-view-container-{{format-date classActivity.added_date 'YYYY-MM-DD'}}">
                <div class="dca-date-container {{if (eq today classActivity.added_date) 'dca-date-container-today'}}">
                  {{#if (eq today classActivity.added_date)}}
                    <span>{{t 'student-landing.class.class-activities-tab.today'}}</span>
                  {{else}}
                    {{gru-icon name="calendar_today"}}
                    <span>{{format-date classActivity.added_date 'MMMM DD, YYYY'}}</span>
                  {{/if}}
                </div>
                <hr />
              </div>
              <div class="dca-content-list-container {{if (eq today classActivity.added_date) 'dca-content-list-container-today'}}">
                {{#each classActivity.classActivities as |activity|}}
                  {{class.gru-class-activity-panel
                    classActivity=activity
                    classId=classId
                    class=class
                    members=members
                    classActivities=classActivities
                    onReportclick='changeStatusValue'
                    onGoLive='goLive'
                    showDcaAssignButton=true
                    showDcaAddButton=false
                    onChangeVisibility='changeVisibility'
                    onRemoveClassActivity='removeClassActivity'
                    openDcaContentReport='openDcaContentReport'
                    activityDate=classActivity.added_date
                    showCohort=true
                    onScheduleContentToDCA='onScheduleContentToDCA'
                    onOpenPerformanceEntry="onOpenPerformanceEntry"
                    onPreviewContent="onPreviewContent"
                    onUpdateMasteryAccrual="onUpdateMasteryAccrual"
                    showMasteryAccrual=showMasteryAccrual
                  }}
                {{else}}
                  <p class="add-content-message">{{t 'common.plan-an-activities-msg'}}</p>
                {{/each}}
              </div>
            {{/each}}
          </div>
        {{else}}
          <div class="no-content">{{t "common.no-dca-teacher"}}</div>
          <div class="no-content-image"></div>
        {{/if}}
      </div>
    </div>
    <div class="ca-right-panel hidden-xs hidden-sm">
      <div class="ca-unschedule-items-list-container">
        <div class="ca-unschedule-items-header">
          <span>{{t 'common.unscheduled-items'}} ({{unScheduledClassActivities.length}})</span>
        </div>
        {{#if unScheduledClassActivities}}
          <div class="ca-unscheduled-content-items">
            {{#each unScheduledClassActivities as |classActivity|}}
              {{class.gru-class-activity-panel
            classActivity=classActivity
            classId=classId
            members=members
            onReportclick='changeStatusValue'
            classActivities=unScheduledClassActivities
            onGoLive='goLive'
            showDcaAssignButton=false
            showDcaAddButton=false
            onChangeVisibility='changeVisibility'
            onRemoveClassActivity='removeClassActivity'
            openDcaContentReport='openDcaContentReport'
            activityDate=classActivity.added_date
            showDcaRemoveButton=false
            onScheduleContentToDCA='onScheduleContentToDCA'
            isUnScheduled=true
            onPreviewContent="onPreviewContent"
          }}
            {{/each}}
          </div>
        {{else}}
          <div class="ca-unscheduled-no-content-items">
            {{t 'common.no-unschedule-items'}} {{format-date forFirstDateOfMonth 'MMMM YYYY'}}.
          </div>
        {{/if}}
      </div>
    </div>
  </div>
  <div class="ca-datepicker-schedule-container ca-datepicker-popover-container">
    {{ca-date-picker userStartDateAsToday=true onSelectDate='onScheduleDate'  showMonths=true onSelectMonth='onScheduleForMonth'}}
  </div>
</div>
{{#if unScheduledClassActivities}}
  {{teacher.class.ca-unscheduled-items-pullup
    showPullUp=true
    classId=classId
    class=class
    unScheduledClassActivities=unScheduledClassActivities
    onChangeVisibility='changeVisibility'
    onRemoveClassActivity='removeClassActivity'
    forFirstDateOfMonth=forFirstDateOfMonth
    class="hidden visible-xs visible-sm"
  }}
{{/if}}
{{#if showSearchContentPullup}}
  {{teacher.class.ca-search-content-pull-up
    showPullUp=showSearchContentPullup
    addedContentToDCA="addedContentToDCA"
    context=contextParams
    selectedSearchContentType=selectedSearchContentType
    todaysClassActivities=todaysClassActivities.classActivities
    classPreference=classPreference
    classId=classId
    onPreviewContent="onPreviewContent"
  }}
{{/if}}
{{#if showDcaCollectionReportPullUp}}
  {{#if (not-eq dcaCollectionReportData.collection.format 'collection-external')}}
    {{reports.pull-up.dca-collection-report
      context=dcaCollectionReportData
      showPullUp=showDcaCollectionReportPullUp}}
  {{else}}
    {{reports.pull-up.dca-external-collection-report
      context=dcaCollectionReportData
      showPullUp=showDcaCollectionReportPullUp}}
  {{/if}}
{{/if}}

<!-- Assessment Performance Entry -->
{{#if isShowAssessmentPerformanceEntryPullUp}}
  {{#reports.pull-up.activity.add-performance-data
    showPullUp = isShowAssessmentPerformanceEntryPullUp
    activityDate = selectedActivity.activation_date
    activityTitle = selectedItem.title
    onClosePullUp = "onClosePerformanceEntry"
    populatedTopPos = '8%'
  }}
    {{reports.pull-up.activity.add-student-performance-data
      collection=selectedItem
      course=course
      students=activityMembers
      activityData=selectedActivity
      classId=classId
    }}
  {{/reports.pull-up.activity.add-performance-data}}
{{/if}}

{{#if isShowCollectionPerformanceEntryPullUp}}
  {{#reports.pull-up.performance-manual-entry isShowPullUp=isShowCollectionPerformanceEntryPullUp title=selectedItem.title type='collection' onClosePerformanceEntry='onClosePerformanceEntry' }}
    {{reports.pull-up.collection-performance-entry
      course=course
      collection=selectedItem
      students=activityMembers
      activityData=selectedActivity
      classId=classId
      onClosePerformanceEntry="onClosePerformanceEntry"}}
  {{/reports.pull-up.performance-manual-entry}}
{{/if}}
{{#if isShowExternalAssessmentPeformanceEntryPullUp}}
  {{#reports.pull-up.performance-manual-entry isShowPullUp=isShowExternalAssessmentPeformanceEntryPullUp title=selectedItem.title type="assessment-external" onClosePerformanceEntry='onClosePerformanceEntry' }}
    {{reports.pull-up.external-assessment-performance-entry
      course=course
      assessment=selectedItem
      students=activityMembers
      activityData=selectedActivity
      classId=classId
      onClosePerformanceEntry="onClosePerformanceEntry"}}
  {{/reports.pull-up.performance-manual-entry}}
{{/if}}
{{#if isShowExternalCollectionPeformanceEntryPullUp}}
  {{#reports.pull-up.performance-manual-entry isShowPullUp=isShowExternalCollectionPeformanceEntryPullUp title=selectedItem.title type="collection-external" onClosePerformanceEntry='onClosePerformanceEntry' }}
    {{reports.pull-up.external-collection-performance-entry
      course=course
      collection=selectedItem
      students=activityMembers
      activityData=selectedActivity
      classId=classId
      onClosePerformanceEntry="onClosePerformanceEntry"}}
  {{/reports.pull-up.performance-manual-entry}}
{{/if}}
{{#if isShowOCASummaryReportPullUp}}
  {{teacher.offline-class.oca-summary-report-pull-up
    classId=class.id
    performanceSummary=performanceSummaryForDCA
    onClosePullUp="onClosePullUp"}}
{{/if}}

{{#if isShowContentPreview}}
  {{reports.pull-up.gru-collection-preview
    showPullUp=isShowContentPreview
    previewContentId=previewContent.id
    previewContentType=previewContentType}}
{{/if}}
