<div class="class-activities-container">
  <div class="header-container">
    <div class="activity-tab">
      <div class="schedule-icon {{if isShowScheduledActivities 'active'}}" {{action "onloadScheduledClassActivities"}}>
        <span>{{t 'class-activity.scheduled-activities'}}</span>
        {{gru-icon name="event"}}
      </div>
      <div class="unscheduled-activity-selector {{if isShowUnscheduledActivities 'active'}}" {{action "onLoadUnscheduledActivities"}}>
        <span> {{t 'class-activity.unscheduled-activities'}}</span>
        {{gru-icon name="event_busy"}}
      </div>
      <div class="items-to-grade-selector {{if isShowItemsToGrade 'active'}}" {{action "onShowItemsToGrade"}}>
        <span> {{t 'class-activity.items-to-grade'}}({{gradingItemsList.length}})</span>
        <i class="grading-icon"></i>
      </div>
    </div>
    {{#unless isShowItemsToGrade}}
      <div class="filters">
        <div class="activities">
          <div class="activities-content">
            <div class="contents-selector">
              {{#each contentTypes as |content|}}
                <div class="content-selector {{if content.isActive 'active'}}" {{action "onToggleContent" content bubbles=false}}>
                  <i class="icon {{content.type}}-icon"></i>
                </div>
              {{/each}}
            </div>
          </div>
        </div>
        <div class="activity-date-range-selector" {{action "onToggleDatePicker"}}>
          <span class="schedule-date"><span>{{format-date startDate 'DD MMM YYYY'}}</span><span class="{{unless isShowListCard 'hidden'}}"> - {{format-date endDate 'DD MMM YYYY'}}</span></span>
          <span class="dropdown-icon">{{gru-icon name="arrow_drop_down"}}</span>
        </div>
      </div>
    {{/unless}}
    <div class="date-range-picker-container ">
      <div class="date-range-selector">
        {{#unless isShowUnscheduledActivities}}
          <span class="{{if isDaily 'active'}} {{if isShowUnscheduledActivities 'disabled'}}" {{action "onSelectRangeType" 'daily'}}>{{t 'common.daily'}}</span>
          <span class="{{if isWeekly 'active'}} {{if isShowUnscheduledActivities 'disabled'}}" {{action "onSelectRangeType" 'weekly'}}>{{t 'common.weekly'}}</span>
        {{/unless}}
        <span class="{{if isMonthly 'active'}}" {{action "onSelectRangeType" 'monthly'}}>{{t 'common.monthly'}}</span>
      </div>
      {{#if isDaily}}
        {{ca-date-picker
          showPreviousMonth="showPreviousMonth"
          showNextMonth="showNextMonth"
          forMonth=forMonth
          forYear=forYear
          onSelectDate="onSelectDate"
          updateMonthAndYear=false
          highlightFirstDayOfMonth=false
          onSelectToday="onSelectToday"
          showToday=true
          selectedDate=selectedDate
          activities=scheduledClassActivitiesDatewise
          highlightActivities=true
          closeDatePicker = "closeDatePicker"
        }}
      {{else if isWeekly}}
        {{ca-week-picker
          forMonth=forMonth
          forYear=forYear
          onSelectWeek="onSelectWeek"
          showPreviousMonth="showPreviousMonth"
          showNextMonth="showNextMonth"
          selectedWeekDate=selectedWeekDate
          activities=scheduledClassActivitiesDatewise
          highlightActivities=true
          closeDatePicker = "closeDatePicker"
          }}
      {{else}}
        {{ca-month-picker
          forMonth=forMonth
          forYear=forYear
          showCalendarView=true
          onSelectMonth="onSelectMonth"
          selectedMonth=selectedMonth
          closeDatePicker = "closeDatePicker"
        }}
      {{/if}}
    </div>
  </div>
  <div class="body-container {{unless isShowItemsToGrade 'content-selecter'}}">
    <div class="activities-cards-container {{if isShowListCard 'list-view' 'card-view'}}">
    {{#unless isLoading}}
      {{#if isShowUnscheduledActivities}}
        {{#each unScheduledActivities as |unScheduledActivity|}}
          {{new-cards/gru-class-activity-card
            activity = unScheduledActivity
            isUnscheduledActivity = true
            onRescheduleActivity = "onRescheduleActivity"
            onShowContentPreview = "onShowContentPreview"
            isShowListView = isShowListCard
          }}
        {{else}}
          <div class="plan-activities-msg">
            {{#if isMobileView}}
              {{t 'class-activity.no-activity-unscheduled-message-mobile' selectedItem=selectedFilter}}
            {{else}}
              {{t 'class-activity.no-activity-unscheduled-message-desktop' selectedItem=selectedFilter}}
            {{/if}}
          </div>
        {{/each}}
      {{/if}}

      {{#if isShowScheduledActivities}}
        {{#each scheduledActivitiesList as |scheduledActivity|}}
          {{#if isShowListCard}}
            <div class="added-date">{{format-date scheduledActivity.added_date 'DD MMM YYYY'}}
              <hr />
            </div>
          {{/if}}
          {{#each scheduledActivity.scheduledActivities as |activity|}}
            {{new-cards/gru-class-activity-card
                activity = activity
                onRemoveActivityClass='removeActivityClass'
                onShowStudentsList = "onShowStudentsList"
                onOpenPerformanceEntry = "onOpenPerformanceEntry"
                onClosePerformanceEntry = "onClosePerformanceEntry"
                onRescheduleActivity = "onRescheduleActivity"
                onEnableMastery = "onEnableMastery"
                onShowContentPreview = "onShowContentPreview"
                onGradeItem="onGradeItem"
                isShowListView=isShowListCard
                onShowContentReport='onShowContentReport'}}
          {{/each}}
        {{else}}
          <div class="plan-activities-msg">
            {{#if isMobileView}}
              {{t 'class-activity.no-activity-scheduled-message-mobile' selectedItem=selectedFilter}}
            {{else}}
              {{t 'class-activity.no-activity-scheduled-message-desktop' selectedItem=selectedFilter}}
            {{/if}}
          </div>
        {{/each}}
      {{/if}}

      {{#if isShowItemsToGrade}}
        {{#each gradingItems as |gradingItem|}}
          {{new-cards/gru-activity-grading-card
            gradingItem=gradingItem
            onGradeItem="onGradeItem"}}
        {{else}}
          <div class="plan-activities-msg">
            {{#if isMobileView}}
              {{t 'class-activity.no-activity-items-to-grade-message-mobile' selectedItem=selectedFilter}}
            {{else}}
              {{t 'class-activity.no-activity-items-to-grade-message-desktop' selectedItem=selectedFilter}}
            {{/if}}
          </div>
        {{/each}}
      {{/if}}
      {{/unless}}
      {{#if isLoading}}
      {{three-bounce-spinner}}
      {{/if}}
    </div>
  </div>
</div>

{{#if isShowDaterangePicker}}
  <div class="ca-datepicker-schedule-container ca-datepicker-popover-container">
    {{ca-daterange-datepicker
      closeDatePicker='onCloseDaterangePicker'
      onScheduleForDate='onScheduleByDate'
      onScheduleForMonth='onScheduleByMonth'
      endDate=endDate
      allowTwoDateRangePicker=allowTwoDateRangePicker}}
  </div>
{{/if}}

{{#if isShowStudentsList}}
  {{teacher/class/ca-student-list-pull-up
    classActivity = selectedActivityClass.activity
    classId = selectedActivityClass.id
    members = selectedActivityClass.members
    showPullUp = isShowStudentsList}}
{{/if}}

<!-- Acitvity Add Performance Data -->
{{#if isShowAddData}}
  {{#reports/pull-up/activity/add-performance-data
    showPullUp = isShowAddData
    activityDate = selectedClassActivity.activationDate
    activityTitle = selectedActivityContent.title
    onClosePullUp = "onClosePerformanceEntry"
    contentType = selectedActivityContent.collectionType
  }}
    {{reports/pull-up/activity/add-student-performance-data
      collection = selectedActivityContent
      course = selectedClassData.course
      class = selectedClassData
      students = selectedClassActivityMembers
      activityData = selectedClassActivity
      onClosePullUp = "onClosePerformanceEntry"
      contentType = selectedActivityContent.collectionType
    }}
  {{/reports/pull-up/activity/add-performance-data}}
{{/if}}

{{#if isShowQuestionGrading}}
  {{grade/pull-up/free-response-question-grade
    isDCAContext=true
    showPullUp=isShowQuestionGrading
    context=gradingObject
    itemsToGrade=gradingItemsList
    onClosePullUp="onClosePerformanceEntry"
    refreshItem="onRefreshItemsToGrade"
  }}
{{/if}}
{{#if isShowOaGrading}}
  {{activity/offline/grading-report
    showPullUp=isShowOaGrading
    context=gradingObject
    itemsToGrade=gradingItemsList
    isTeacher=true
    refreshItem='onRefreshItemsToGrade'
    onClosePullUp="onClosePerformanceEntry"
  }}
{{/if}}

<!-- Preview -->
{{#if isShowContentPreview}}
  {{reports/pull-up/gru-collection-preview
    showPullUp=isShowContentPreview
    previewContentId=previewContent.contentId
    previewContentType=previewContent.contentType
    isReportView=isReportView}}
{{/if}}

{{#if isShowStudentsSummaryReport}}
{{teacher/offline-class/oca-students-summary-report-pull-up
    context=selectedActivity
    classActivities=reportActivityList
    onOpenPerformanceEntry='onOpenPerformanceEntry'
    classId=selectedActivity.classId
    isShowAddData=isShowAddData
    showPullUp=isShowStudentsSummaryReport}}
{{/if}}

{{#if isShowOfflineActivityPreview}}
  {{reports/pull-up/oa-preview
    showPullUp=isShowOfflineActivityPreview
    oaId=previewContent.contentId
    classActivity=previewContent
    classId=previewContent.classId
  }}
{{/if}}
