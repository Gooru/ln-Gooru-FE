{{#if headers}}
  <div class="metrics-table-wrapper">
    {{#if isLoading}}
    <button class="btn btn-sm btn-warning"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Loading...</button>
    {{else}}
    <table class="table">
      <thead>
        <tr class="headers">
          <th class=" header htFixed"></th>
          <th class="header" scope="col">
            {{t "class.analytics.performance.teacher.metricsTable.average"}}
          </th>
          {{#each headers as |header index|}}
             {{#if (eq header.collectionType 'collection')}}
                <th id="{{{header.id}}}" class="header" scope="col">
                    <div class="header-title">
                        <div class="column">
                            {{#if header.collectionType}}
                                <div class="prefix">{{{course-sections-prefix index=index type=header.collectionType longName=false}}}</div>
                            {{else}}
                                <div class="prefix">{{{course-sections-prefix index=index type=headerType longName=false}}}</div>
                            {{/if}}
                              <div class="title" title="{{header.title}}" data-toggle="tooltip" data-placement="auto">{{{truncate text=header.title maxLength=14 suffix=true}}}</div>
                        </div>
                        <div class="small-icon">{{gru-icon "play_arrow"}}</div>
                    </div>
                </th>
            {{else}} 
            {{#if header.showSub}}
                <th colspan="{{header.colspanval}}">
                   <div class="header-title pull-left">
                        <div class="column">
                            <div class="titlenew" title="{{header.title}}" data-toggle="tooltip" data-placement="auto">{{{header.title}}}</div>
                          {{#if header.showAssessments}}
                           <div class="text-newprimary" {{action 'showlessons' index}}>Show Lessons</div>
                           {{else}}
                            <div class="text-newprimary" {{action 'showassessments' index}}>Show Assessments</div>
                          {{/if}}
                        </div>
                          </div>  
                <th id="{{{header.id}}}"  class="header pointer subsubwidthmaxCollapse" scope="col">
   
                        <div class="text-newprimary" {{action 'collapse' index}}>Collapse</div>

                    </th>
           
            
                  {{#each header.subColumns as |subHeader index|}}
                    {{#if header.showSubSub}}
                    <th id="{{{subHeader.id}}}" class="header pointer" scope="col">
                    <div class="header-title">
                        <div class="column">
                            <div class="title" title="{{subHeader.title}}" data-toggle="tooltip" data-placement="auto">{{{truncate text=subHeader.title maxLength=14 suffix=true}}}</div>
                        </div>
                    </div>
                    {{#each subHeader.subsubColumns as |subsubHeader index|}}
                    {{#if (eq subsubHeader.collectionType 'assessment')}}
                   <th id="{{{subsubHeader.id}}}" class="header pointer subsubwidthmax" scope="col">
                    <div class="header-title">
                        <div class="column">
                            <div class="title" title="{{subsubHeader.title}}" data-toggle="tooltip" data-placement="auto">{{{truncate text=subsubHeader.title maxLength=14 suffix=true}}}</div>
                        </div>
                    </div>
                </th>
                {{/if}} 
                {{/each}}
                    </th>
                    {{else}}
                    <th id="{{{subHeader.id}}}" class="header pointer" scope="col">
                    <div class="header-title">
                        <div class="column">
                            <div class="title" title="{{subHeader.title}}" data-toggle="tooltip" data-placement="auto">{{{truncate text=subHeader.title maxLength=14 suffix=true}}}</div>
                        </div>
                    </div>
                    </th>
                     {{/if}} 
                {{/each}}
            </th>
         
             {{else}}
                <th id="{{{header.id}}}"  class="header pointer" scope="col">
                    <div class="header-title">
                        <div class="column">
                            <div class="title" title="{{header.title}}" data-toggle="tooltip" data-placement="auto">{{{truncate text=header.title maxLength=14 suffix=true}}}</div>
                        </div>
                          </div>
                        {{#if header.showSub}}
                        <div class="text-newprimary" {{action 'collapse' index}}>Collapse</div>
                         {{else}}
                        <div class="text-newprimary" {{action 'expand' index}}>Expand</div>
                        {{/if}}
                    </th>
            {{/if}}
     
             {{/if}} 
          {{/each}}
        </tr>
        {{!-- <tr class="sub-header hidden-xs">
          <th class="fixed">
            {{class.analytics.performance.teacher.gru-metrics-sub-header onSortChange='sortChange' metrics=averageMetrics}}
          </th>
          <th class="widthmaxi">
            {{class.analytics.performance.teacher.gru-metrics-sub-header onSortChange='sortChange' dataPickerOptions=dataPickerOptions}}
          </th>
          {{#each columns as |header|}}
            <th class="widthmaxi">
              {{class.analytics.performance.teacher.gru-metrics-sub-header onSortChange='sortChange' dataPickerOptions=dataPickerOptions showReport=isCollection}}
            </th>
          {{#if header.showSub}}
              {{#each header.subColumns as |subHeader|}}
              <th class="widthmaxi">
                {{class.analytics.performance.teacher.gru-metrics-sub-header onSortChange='sortChange' dataPickerOptions=dataPickerOptions showReport=isCollection}}
              </th>
            {{/each}}
          {{/if}}  
          {{/each}}
        </tr> --}}
         <tr class="average">
          <th class="header fixed backgroundclraverage" scope="row">
             <span class="class-average">
               {{t "class.analytics.performance.teacher.metricsTable.class-average"}}
             </span>
          </th>
          {{#each averageHeaders.performanceData as |average index|}}
            <th class="performance-information backgroundclraverage">
            {{#if (eq index 0)}}
              {{class.analytics.performance.teacher.gru-metrics-performance-information performanceData=average dataPickerOptions=dataPickerOptions showReport=false}}
            {{else}}
              {{class.analytics.performance.teacher.gru-metrics-performance-information performanceData=average dataPickerOptions=dataPickerOptions showReport=isCollection
              isAverage=true}}
            {{/if}}
            </th>
          {{/each}}
           {{!-- {{#each averageHeadersLesson.performanceData as |average index|}}
            <th class="performance-information">
            {{#if (eq index 0)}}
              {{class.analytics.performance.teacher.gru-metrics-performance-information performanceData=average dataPickerOptions=dataPickerOptions showReport=false}}
            {{else}}
              {{class.analytics.performance.teacher.gru-metrics-performance-information performanceData=average dataPickerOptions=dataPickerOptions showReport=isCollection
              isAverage=true}}
            {{/if}}
            </th>
          {{/each}}
          {{#each averageHeadersAssessment.performanceData as |average index|}}
            <th class="performance-information">
            {{#if (eq index 0)}}
              {{class.analytics.performance.teacher.gru-metrics-performance-information performanceData=average dataPickerOptions=dataPickerOptions showReport=false}}
            {{else}}
              {{class.analytics.performance.teacher.gru-metrics-performance-information performanceData=average dataPickerOptions=dataPickerOptions showReport=isCollection
              isAverage=true}}
            {{/if}}
            </th>
          {{/each}} --}}
        </tr> 
      </thead>
      <tbody>
        {{#each performanceData as |userPerformance index|}}
            <tr>
              <th class="header user-info" scope="row">
                <span>{{{userPerformance.user}}}</span>
              </th>
              {{#each userPerformance.performanceData as |data index|}}
           
                {{#if (eq index 0)}}
                    <td class="performance-information subsubwidthmaxCollapseUnit">
                      {{class.analytics.performance.teacher.gru-metrics-performance-information
                      userPerformance=userPerformance
                      onClickReport='clickReport'
                      performanceData=data dataPickerOptions=dataPickerOptions}}
                    </td>
                  {{else}}
                    <td class="performance-information subsubwidthmaxCollapseUnit">
                      {{class.analytics.performance.teacher.gru-metrics-performance-information
                      userPerformance=userPerformance
                      onClickReport='clickReport'
                      performanceData=data dataPickerOptions=dataPickerOptions
                      showReport=isCollection}}
                    </td>
                {{/if}}
                {{#each data.subColumns as |data1 index|}}
                {{#if (eq index 0)}}
                    <td class="performance-information subsubwidthmax">
                      {{class.analytics.performance.teacher.gru-metrics-performance-information
                      userPerformance=userPerformance
                      onClickReport='clickReport'
                      performanceData=data1 dataPickerOptions=dataPickerOptions}}
                    </td>
                  {{else}}
                    <td class="performance-information subsubwidthmax">
                      {{class.analytics.performance.teacher.gru-metrics-performance-information
                      userPerformance=userPerformance
                      onClickReport='clickReport'
                      performanceData=data1 dataPickerOptions=dataPickerOptions
                      showReport=isCollection}}
                    </td>
                {{/if}}
              {{/each}}
              {{#each data.subsubColumns as |data2 index|}}
                {{#if (eq index 0)}}
                    <td class="performance-information subsubwidthmax1">
                      {{class.analytics.performance.teacher.gru-metrics-performance-information
                      userPerformance=userPerformance
                      onClickReport='clickReport'
                      performanceData=data2 dataPickerOptions=dataPickerOptions}}
                    </td>
                  {{else}}
                    <td class="performance-information subsubwidthmax1">
                      {{class.analytics.performance.teacher.gru-metrics-performance-information
                      userPerformance=userPerformance
                      onClickReport='clickReport'
                      performanceData=data2 dataPickerOptions=dataPickerOptions
                      showReport=isCollection}}
                    </td>
                {{/if}}
              {{/each}}
              {{/each}}
            </tr>
        {{/each}}

        
      </tbody>
    </table>
    {{/if}}
  </div>
{{else}}
  <span class="no-content">{{t "common.no-content"}}</span>
{{/if}}
