<header>
  {{#if collection}}
    {{#link-to  (if isCollection 'content.collections.edit' 'content.assessments.edit') collection.id class="back-to"}}
        <div class="{{if isCollection 'return-collection' 'return-assessment'}}">
          {{gru-icon name="keyboard_arrow_left"}}{{t (if isCollection 'common.collection' 'common.assessment')}} {{collection.title}}
        </div>
    {{/link-to}}
  {{/if}}

  <h1>{{t "common.edit-question"}}</h1>

  <div class="actions">
      <button class="btn btn-default btn-icon delete" title="{{t 'common.delete'}}" {{action 'deleteQuestion' question}}>{{gru-icon name="delete"}}</button>
      {{#gru-share-pop-over tagName="button" type="question"}}
        {{gru-icon name="insert_link"}}
      {{/gru-share-pop-over}}
      <button class="btn btn-default add"title="{{t 'common.add-to'}}" {{action "addToCollection"}}>{{t "content.questions.edit.add-to"}}</button>
      {{#link-to 'content.questions.play' question.id class="btn btn-default preview" tagName="button"}}{{t "common.preview"}}{{/link-to}}
  </div>

  <nav>
    {{#gru-scroll to="#builder" class="selected" offset='article > header'}}{{t "common.builder"}}{{/gru-scroll}}
    {{#gru-scroll to="#information" offset='article > header'}}{{t "common.information"}}{{/gru-scroll}}
    {{#gru-scroll to="#settings" offset='article > header'}}{{t "common.settings"}}{{/gru-scroll}}
  </nav>

</header>

<section id="builder">
  <div class="header">
    <h2>{{t "common.builder"}} - {{t (concat 'common.question-type.' question.type)}}</h2>
    <div class="actions">
      {{#if isBuilderEditing}}
        <button class="cancel btn btn-info"  {{action 'cancelBuilderEdit'}}>{{t "common.cancel"}}</button>
        <button class="save btn btn-success"{{action 'updateContent'}}>{{t "common.save"}}</button>
      {{else}}
        <button class="edit btn btn-primary" {{action 'editBuilderContent'}}>{{t "common.edit"}}</button>
      {{/if}}
    </div>
  </div>
  <div class="panel panel-default question-text">
    <div class="panel-heading">
      <div class="border-bottom">
        <h3>{{t "common.question"}}</h3>
        <span class="instructions">{{t (concat 'content.questions.edit.builder.question-instructions.' question.type)}}</span>
      </div>
    </div>
    <div class="panel-body">
      {{#if isBuilderEditing}}
        {{validation.gru-textarea rawTextareaValue=tempQuestion.text model=tempQuestion valuePath='text' rows=10 maxLength=5000}}
        <button class="add-image btn btn-sm btn-primary out-of-scope">{{t "common.add-question-image"}}</button>
      {{else}}
        {{#if question.text}}
          {{textarea class="text-question" value=question.text class="form-control" rows="10" readonly=true}}
        {{else}}
          <p class="text-empty">{{t 'common.nothing-to-display'}}</p>
        {{/if}}
      {{/if}}
    </div>
  </div>
  <div class="panel panel-default question-answer">
    <div class="panel-heading">
      <div class="{{unless question.isHotTextHighlight 'border-bottom'}}">
        <h3>{{t "content.questions.edit.builder.answer"}}</h3>
        {{#unless question.isHotTextHighlight}}
          <span class="instructions">{{t (concat 'content.questions.edit.builder.answer-instructions.' question.type)}}</span>
        {{/unless}}
        {{#if correctAnswerNotSelected}}
          <div class="missing-correct-answer">
            <p><small>{{t "common.errors.select-correct-answer"}}</small></p>
          </div>
        {{/if}}
        {{#if hasNoImages}}
          <div class="missing-images">
            <p><small>{{t "common.errors.answer-has-no-image"}}</small></p>
          </div>
        {{/if}}
      </div>
    </div>
    <div class="panel-body">
      {{#if isBuilderEditing}}
        {{component (questionConfig question.type 'component.builder_answer') answers=tempQuestion.answers editMode=true}}
      {{else}}
        {{component (questionConfig question.type 'component.builder_answer') answers=question.answers}}
      {{/if}}
    </div>
    {{#if isBuilderEditing}}
      <div class="panel-footer out-of-scope">
        <button class="add-hint btn btn-sm btn-primary">{{t "content.questions.edit.builder.add-hint"}}</button>
        <button class="add-explanation btn btn-sm btn-primary">{{t "content.questions.edit.builder.add-explanation"}}</button>
      </div>
    {{/if}}
  </div>
  {{#if isBuilderEditing}}
    <div class="footer">
      <div class="actions">
          <button class="cancel btn btn-info"  {{action 'cancelBuilderEdit'}}>{{t "common.cancel"}}</button>
          <button class="save btn btn-success"{{action 'updateContent'}}>{{t "common.save"}}</button>
      </div>
    </div>
  {{/if}}
</section>

<section id="information">
    <div class="header">
        <h2>{{t "common.information"}}</h2>
      {{partial 'content/partials/information-actions'}}
    </div>
    <div class="content">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="title-section">
                    <div class="title">
                        <label>
                            <span class="required">{{t "content.questions.edit.information.question-title"}}</span>
                          {{#if isEditing}}
                            {{validation.gru-input model=tempQuestion valuePath='title' maxLength=50}}
                          {{else}}
                              <b>{{{question.title}}}</b>
                          {{/if}}
                        </label>
                    </div>
                    <div class="question-types">
                        <label>
                           <span class="required">{{t "content.questions.edit.information.question-type"}}</span>
                          {{!--{{#if isEditing}}
                              <div class="btn-group">
                                  <a href="#" class="btn btn-primary btn-sm" data-toggle="dropdown">
                                      <span>
                                         {{#if tempQuestion.type}}
                                           {{#if (eq questionType 'T/F')}}
                                             {{t 'common.question-type.T_F'}}
                                             {{else}}
                                             {{t (concat 'common.question-type.' tempQuestion.type) }}
                                           {{/if}}
                                        {{else}}
                                          {{t 'common.select-question-type'}}
                                        {{/if}}</span>
                                   </a>
                                  <a href="#" class="btn btn-primary btn-sm dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></a>
                                  <ul class="dropdown-menu dropdown-menu-right">
                                    {{#each questionTypes as |questionType|}}
                                        <li><a {{action 'selectType' questionType }}>{{t (concat 'common.question-type.' questionType) }}</a></li>
                                    {{/each}}
                                  </ul>
                              </div>
                          {{else}} --}}
                              <div class="btn-empty btn btn-sm">{{t (concat 'common.question-type.' question.type) }}</div>
                          {{!--  {{/if}} --}}
                        </label>
                    </div>
                </div>
                <div class="standards">
                  {{#if isEditing}}
                    {{taxonomy.gru-taxonomy-selector
                    isEditing=isEditing
                    onSubjectSelected="selectSubject"
                    selectedSubject=selectedSubject
                    internalCategory=k12Category
                    subjectLabelKey='common.subject-and-framework'
                    showCategories=false
                    showCourses=false
                    onlySubjectsWithStandards=true
                    }}
                  {{/if}}
                  <div>
                    <label class="title">
                      <span>{{t "common.standards"}}</span>
                    </label>
                    {{#if isEditing}}
                      <button type="button" class="btn btn-primary"
                        {{action 'openTaxonomyModal'}}
                              disabled={{standardDisabled}}>
                        {{gru-icon name="open_in_new"}} {{t "common.select"}}
                      </button>
                      <div class="tags">
                          {{taxonomy.gru-taxonomy-tag-list tags=editableTags onRemove=(action 'removeTag')}}
                      </div>
                    {{else}}
                      <div class="tags">
                        {{#if tags.length}}
                          {{taxonomy.gru-taxonomy-tag-list tags=tags}}
                        {{else}}
                          {{t "common.not-specified"}}
                        {{/if}}
                      </div>
                    {{/if}}
                  </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="settings">
  {{partial 'content/partials/settings'}}
</section>
