<div class="weekly-report-container">
  <div class="report-period-selector">
    <div class="active-period" {{action "onToggleReportPeriod"}}>
      <span class="report-period-text">{{activeReportPeriod.text}}</span>
      <span class="toggle-icon">{{gru-icon name="arrow_drop_down"}}</span>
    </div>
    <div class="report-periods">
      {{#each reportPeriods as |reportPeriod|}}
        <div class="report-period {{if (eq activeReportPeriod.value reportPeriod.value) 'active-report-period'}}" {{action "onSelectReportPeriod" reportPeriod}}>
          {{reportPeriod.text}}
        </div>
      {{/each}}
    </div>
  </div>
  <div class="header-container {{if isShowStudentCompetencies 'student-competencies-activate'}}">
    <div class="header-left">
      {{t 'common.name'}}
    </div>
    <div class="header-right">
      <div class="competencies-label">
        <div class="label-text">{{t 'common.competencies'}}</div>
        <div class="sub-header">
          <div class="gained-header">{{t 'common.gained'}}</div>
          <div class="inprogress-header">{{t 'profile.proficiency.in-progress'}}</div>
        </div>
      </div>
      <div class="timespent-label">
        <div class="label-text">{{t 'gru-data-picker.time-spent'}}</div>
        <div class="sub-header">
          <div class="collection-header">{{t 'common.collections'}}</div>
          <div class="assessment-header">{{t 'common.assessments'}}</div>
          <div class="total-header">{{t 'reports.gru-table-view.totals'}}</div>
        </div>
      </div>
      <div class="badge-earned-label label-text">
        {{t 'badges-earned'}}
      </div>
      <div class="average-score-label label-text">
        {{t 'common.averageScore'}}
      </div>
      <div class="suggestion-taken-label label-text">
        {{t 'suggestion-taken'}}
      </div>
    </div>
  </div>
  {{#if isLoading}}
    {{three-bounce-spinner}}
  {{else}}
    <div class="body-container {{if isShowStudentCompetencies 'student-competencies-activate'}}">
      <div class="body-left">
        {{#each studentsSummaryReportData as |reportData|}}
          <div class="student-info-container {{if (or reportData.weeklyReportData.masteredCompetenciesCount reportData.weeklyReportData.inprogressCompetenciesCount) 'data-available'}} {{if reportData.active 'active-student'}}" {{action "onSelectStudent" reportData}}>
            <div class="student-thumbnail" style="background-image: url({{reportData.student.thumbnailUrl}});"></div>
            <div class="student-name">{{reportData.student.fullName}}</div>
          </div>
        {{/each}}
      </div>
      <div class="body-right">
        {{#each studentsSummaryReportData as |reportData|}}
          <div class="student-summary-container">
            <div class="gained-competencies {{if reportData.active 'active-student'}}">
              {{#if reportData.weeklyReportData.masteredCompetenciesCount}}
                <span class="competency-status-5 competency-status"></span> <span class="competency-count">{{reportData.weeklyReportData.masteredCompetenciesCount}}</span>
              {{else}}
                --
              {{/if}}
            </div>
            <div class="inprogress-competencies {{if reportData.active 'active-student'}}">
              {{#if reportData.weeklyReportData.inprogressCompetenciesCount}}
                <span class="competency-status-1 competency-status"></span> <span class="competency-count">{{reportData.weeklyReportData.inprogressCompetenciesCount}}</span>
              {{else}}
                --
              {{/if}}
            </div>
            <div class="collection-timespent">
              <span class="time-spent">
                {{#if reportData.weeklyReportData.collectionTimespent}}
                  {{format-time reportData.weeklyReportData.collectionTimespent}}
                {{else}}
                  --
                {{/if}}
              </span>
            </div>
            <div class="assessment-timespent">
              <span class="time-spent">
                {{#if reportData.weeklyReportData.assessmentTimespent}}
                  {{format-time reportData.weeklyReportData.assessmentTimespent}}
                {{else}}
                  --
                {{/if}}
              </span>
            </div>
            <div class="total-timespent">
              <span class="time-spent">
                {{#if reportData.weeklyReportData.totalTimespent}}
                  {{format-time reportData.weeklyReportData.totalTimespent}}
                {{else}}
                  --
                {{/if}}
              </span>
            </div>
            <div class="badge-earned">
              {{#if reportData.weeklyReportData.badgeEarned}}
                <span class="badge"><span class="badge-count">{{reportData.weeklyReportData.badgeEarned}}</span></span>
              {{else}}
                --
              {{/if}}
            </div>
            <div class="average-score">
              {{#unless reportData.weeklyReportData.isNotStarted}}
                <span class="score score-range-{{grade-range reportData.weeklyReportData.averageScore}}">{{reportData.weeklyReportData.averageScore}}</span>
              {{else}}
                --
              {{/unless}}
            </div>
            <div class="suggestion-taken">
              {{#if reportData.weeklyReportData.suggestionTaken}}
                <span class="suggestion-count">{{reportData.weeklyReportData.suggestionTaken}}</span>
              {{else}}
                --
              {{/if}}
            </div>
            {{#if reportData.active}}
              <div class="active-student-data" {{action "onRemoveActiveStudentData"}}>
                {{gru-icon name="clear"}}
              </div>
            {{/if}}
          </div>
        {{/each}}
      </div>
      {{#if isShowStudentCompetencies}}
        <div class="student-competencies-container">
          {{#each studentDomainCompetencies as |domainCompetencies|}}
            <div class="domain-name">{{locale-translation (t (concat 'domain-code.' domainCompetencies.domainCode)) domainCompetencies.domainName}}</div>
            <div class="competencies">
              {{#each domainCompetencies.competencies as |competency|}}
                <div class="student-competency">
                  <div class="code-info">
                    <div class="display-code">{{competency.displayCode}}</div>
                    <div class="status competency-status-{{competency.status}}"></div>
                    <div class="short-desc ellipsis">{{competency.competencyStudentDesc}}</div>
                  </div>
                  <div class="competency-name">
                    {{competency.competencyName}}
                  </div>
                </div>
              {{/each}}
            </div>
          {{/each}}
        </div>
      {{/if}}
    </div>
  {{/if}}
</div>
