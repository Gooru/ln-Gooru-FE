{{#if isLoading}}
  <div class="loading-spinner">{{three-bounce-spinner}}</div>
{{/if}}
{{#if isShowAtcView}}
  {{#if isPremiumClass}}
    <div class="performance-overview-header">
      <div class="month-picker {{if isCurrentMonth 'current-month'}}">
        {{ca-date-picker
            showToday=true
            forMonth=activeMonth
            allowDateSelectorToggle=true
            forYear=activeYear
            showPreviousMonth="onChangeMonth"
            showNextMonth="onChangeMonth"
          }}
      </div>
    </div>

    <div class="data-view-container navigator-class">
      <div class="chart-container">
        <div class="chart-area">
          {{teacher/class/navigator-atc-view classData=class month=activeMonth year=activeYear}}
        </div>
      </div>
      <div class="data-analysis-cards-container">
        <div class="competency-card-container" {{action "onSelectGrade"}}>
          <div class="title-container">{{t 'teacher-landing.class.atc-view.learning-challenges'}} ({{currentGradeName}})</div>
          {{#each gradeCompetencyDomainList as |competency domainIndex|}}
            <div class="competency-struggling-container">
              <div class="competency-heading" {{action "onSelectGrade" domainIndex bubbles=false}}>
                <div class="competency-heading-title">{{competency-gut-to-fw-transform
                   fwCompetencies
                   competency.code
                   competency.name
                   'frameworkCompetencyName'
                   showGutCompetency
                   true
                  }}</div>
                <ul class="competency-sub-heading">
                  <li title="{{domain-gut-to-fw-transform
                    fwDomains
                    competency.domainCode
                    competency.domainName
                    'fwDomainName' true}}" data-toggle="tooltip">
                    {{domain-gut-to-fw-transform
                      fwDomains
                      competency.domainCode
                      competency.domainName
                      'fwDomainName' true
                    }}
                  </li>
                  <li title="{{competency.displayCode}}" data-toggle="tooltip">{{competency.displayCode}}</li>
                  <li title="{{competency-lo-transform
                    fwCompetencies
                    competency.code
                    'loCode'
                    false
                    '|'
                    }}" data-toggle="tooltip">{{competency-lo-transform
                      fwCompetencies
                      competency.code
                      'loCode'
                      false
                      '|'
                    }}</li>
                </ul>
              </div>
              <div class="competency-icon" {{action "onSelectCompetency" competency}}>
                {{gru-icon name="explore"}}
              </div>
              <div class="competency-count" {{action "onShowStudentList" competency}}>
                <span class="student-count">
                  {{competency.studentsCount}}
                </span>
                {{gru-icon name="person"}}
              </div>
            </div>
          {{else}}
            <span>{{t 'common.no-struggling-competencies'}}</span>
          {{/each}}
        </div>
        <div class="competency-card-container other-grade" {{action "onSelectOtherGrade"}}>
          <div class="title-container">{{t 'teacher-landing.class.atc-view.learning-gaps'}}</div>
          {{#if otherGradeTopComp.length}}
            {{#each otherGradeTopComp as |competency competencyIndex|}}
              <div class="competency-struggling-container">
                <div class="competency-heading" {{action "onSelectOtherGrade" competency.gradeIndex competency.domainIndex bubbles=false}}>
                  <div class="competency-heading-title">{{competency-gut-to-fw-transform
               fwCompetencies
               competency.code
               competency.name
               'frameworkCompetencyName'
               showGutCompetency
               true
              }}</div>
                  <ul class="competency-sub-heading">
                    <li title="{{domain-gut-to-fw-transform
                fwDomains
                competency.domainCode
                competency.domainName
                'fwDomainName' true}}" data-toggle="tooltip">{{domain-gut-to-fw-transform
                  fwDomains
                  competency.domainCode
                  competency.domainName
                  'fwDomainName' true}}</li>
                    <li title="{{competency.displayCode}}" data-toggle="tooltip">{{competency.displayCode}}</li>
                    <li title="{{competency-lo-transform
                fwCompetencies
                competency.code
                'loCode'
                false
                '|'
              }}" data-toggle="tooltip">{{competency-lo-transform
                fwCompetencies
                competency.code
                'loCode'
                false
                '|'
              }}</li>
                  </ul>
                </div>
                <div class="competency-icon" {{action "onSelectCompetency" competency}}>
                  {{gru-icon name="explore"}}
                </div>
                <div class="competency-count" {{action "onShowStudentList" competency}}>
                  <span class="student-count">
                    {{competency.studentsCount}}
                  </span>
                  {{gru-icon name="person"}}
                </div>
              </div>
            {{/each}}
          {{else}}
            <span>{{t 'common.no-struggling-competencies'}}</span>
          {{/if}}
        </div>
        <div class="activities-count-container" {{action "onRedirectToCA"}}>
          <div class="activities-container completed">
            <div class="activity-count">{{activitiesCount.scheduled}}</div>
            <div class="activities-info"><span><i class="pin-icon"></i></span>{{t 'teacher-landing.class.atc-view.class-activities-completed'}}</div>
          </div>
          <div class="activities-container pending">
            <div class="activity-count">{{activitiesCount.unscheduled}}</div>
            <div class="activities-info"><span><i class="pin-icon"></i></span>{{t 'teacher-landing.class.atc-view.class-activities-pending'}}</div>
          </div>
        </div>
      </div>
    </div>
  {{else}}
    <div class="data-view-container regular-class">
      <div class="chart-container">
        {{teacher/class/atc-chart classData=class isPremiumClass=isPremiumClass}}
      </div>
    </div>
  {{/if}}
{{else}}
  <div class="data-not-available"> {{t 'teacher-landing.class.students-tab.data-not-available'}}</div>
{{/if}}

{{#if isShowCompetencyCompletionReport}}
  {{reports/pull-up/competency-completion-report fwCompetencies=fwCompetencies showPullUp=isShowCompetencyCompletionReport classId=classId activeMonth=activeMonth activeYear=activeYear domainData=selectedDomain competencyCompletionReport=competencyCompletionReport userAgent=userAgent onSuggestAtCompetency="onSuggestAtCompetency" maxLimitToSuggestContent=maxLimitToSuggestContent}}
{{/if}}
{{#if isShowGradeCompetency}}
  {{reports/pull-up/struggling-competency-domain-level fwCompetencies=fwCompetencies selectCompetency="onSelectCompetency" gradeDomainIndex = gradeDomainIndex gradeDomainsList=gradeCompetencyDomainList closePullUp="onCloseGradePullUp"}}
{{/if}}

{{#if isShowOtherGradeCompetency}}
  {{reports/pull-up/struggling-competency-other-grade-level fwCompetencies=fwCompetencies selectCompetency="onSelectCompetency" gradeDomainIndex = gradeDomainIndex otherGradeCompetency = otherGradeCompetency closePullUp="onCloseOtherGrade"}}
{{/if}}

{{#if isShowStrugglingCompetencyReport}}
  {{reports/pull-up/struggling-competency-report
     class=class
     fwCompetencies=fwCompetencies
     onPreviewContent='onPreviewContent'
     onAddContentToDCA ='onAddCollectionToDCA'
     onScheduleContentToDCA = 'onScheduleContentToDCA'
     selectedCompetency = selectedCompetency
     closePullUp="onClosePullUp"
     isShowCompetencyStudentList = isShowCompetencyStudentList
   }}
{{/if}}

<!-- Preview -->
{{#if isShowContentPreview}}
  {{reports/pull-up/gru-collection-preview
    showPullUp=isShowContentPreview
    showAssessmentCode=true
    previewContentId=previewContent.id
    previewContentType=previewContentType}}
{{/if}}

{{#if isShowActivitySearchContentPullup}}
  {{teacher/class/ca-search-content-pull-up
    showPullUp=isShowActivitySearchContentPullup
    addedContentToDCA="addedContentToDCA"
    context=contextParams
    selectedSearchContentType=selectedContentType
    classPreference=classPreference
    classId=classId
    competencyData=selectedCompetencyData
    defaultSearchPageSize=maxLimitToSuggestContent
    isShowMoreEnabled=false
  }}
{{/if}}

<div class="ca-datepicker-schedule-container ca-datepicker-popover-container">
  {{ca-daterange-datepicker
      closeDatePicker='onCloseDatePicker'
      onScheduleForDate='onScheduleDate'
      onScheduleForMonth='onScheduleForMonth'
      endDate=endDate
      allowTwoDateRangePicker=false}}
</div>
