<div class="task-submission-container">
  <div class="task-summary-container">
    <div class="task-icon">
    </div>
    <div class="task-info">
      <div class="task-title">
        {{task.title}}
      </div>
      <div class="pending-submission">
        {{#each typeBasedMandatoryUploads as |mandatoryUpload|}}
          <span>{{mandatoryUpload.pendingCount}} {{mandatoryUpload.type}}</span>,
        {{/each}}
        required
      </div>
    </div>
    {{#unless isPreview}}
      <div class="task-toggle" {{action "onToggleTask"}}>
        {{#if isTaskExpanded}}
          {{gru-icon name="expand_less"}}
        {{else}}
          {{gru-icon name="expand_more"}}
        {{/if}}
      </div>
    {{/unless}}
  </div>
  <div class="task-details-container">
    <div class="task-title">
      {{task.title}}
    </div>
    <div class="task-description">
      {{task.description}}
    </div>
    {{#unless isPreview}}
      <div class="task-upload-container">
        <div class="task-answer">
          <div class="answer-label">
            Your Answer
          </div>
          <div class="input-container">
            {{input type="text" value=task.submissionText class="submission-text" placeholder="Write your answer here..."}}
          </div>
        </div>
        <div class="task-file-upload-container">
          {{#each studentTaskUploadSubmission as |file|}}
            <div class="task-file-preview" data-toggle="tooltip">
              <a href="{{file.submissionInfo}}" target="_blank" class="preview-file-link">
                {{#if (eq file.submissionSubtype 'image')}}
                  <img src="{{file.submissionInfo}}" />
                {{else}}
                  {{#if file.submissionIcon}}
                    <i class="fa {{file.submissionIcon}}"></i>
                  {{else}}
                    {{gru-icon name="insert_drive_file"}}
                  {{/if}}
                {{/if}}
              </a>
            </div>
          {{/each}}

          {{#each listOfFilesUploads as |file index|}}
            <div class="task-file-upload">
              {{#file-picker
            dropzone=false
            errors=fileUploadErrors
            fileLoaded="onUploadFile"
            readAs="readAsFile"
            removePreview=file.isRemovePreview
            onRemoveFile=removeFile}}

                {{!-- A DIV is used instead of a BUTTON because the button's click default behaviour
                  may cause unwanted side-effects if this component is placed in a modal
                   (i.e. clicking on this button will cause the modal to close) --}}
                <div class="file-upload-box">
                  {{gru-icon name="add"}}
                </div>

              {{/file-picker}}
              {{#if file.isFileAvailable}}
                <div class="file-upload-actions">
                  <div class="remove-file" {{action "onRemoveFile" index}}>{{gru-icon name="clear"}}</div>
                </div>
              {{/if}}
            </div>
          {{/each}}
        </div>
        <div class="task-url-upload-container">
          {{#each task.urls as |taskUrl index|}}
            <div class="task-url-upload {{if taskUrl.isSubmittedUrl 'preview-url'}}">
              <span class="url-label">URL {{plus-one index}}: </span>
              {{#if taskUrl.isSubmittedUrl}}
                <a class="url-link" href="{{taskUrl.value}}" target="_blank">{{taskUrl.value}}</a>
              {{else}}
                <span class="url-value">{{input type="text" value=taskUrl.value}}</span>
              {{/if}}
            </div>
          {{/each}}
        </div>
        <div class="save-task-submission {{if isSubmittingTask 'saving'}}" {{action "onSaveTask"}}>
          {{#if isSubmittingTask}}
            Saving<span class="spinner">{{three-bounce-spinner}}</span>
          {{else}}
            Save
          {{/if}}
        </div>
      </div>
    {{/unless}}
  </div>
</div>
