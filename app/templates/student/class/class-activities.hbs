<div class="controller student class class-activities">
  <div class="loading-spinner {{if isLoading 'active'}}">
    {{three-bounce-spinner}}
  </div>
  <div class="activity-date-range-selector hidden-xs">
    <div class="date-section" {{action "toggleDatePicker"}}>
      <span class="schedule-date">
        <span>{{format-date startDate 'DD MMM YYYY'}}</span>
        <span class="{{if (not endDate) 'hidden'}}"> - {{format-date endDate 'DD MMM YYYY'}}
        </span>
      </span>
    </div>
    <div class="date-range-picker-container">
      <div class="date-range-selector">
        <span class="{{if isDaily 'active'}}" {{action "onSelectRangeType" 'daily'}}>{{t 'common.daily'}}</span>
        <span class="{{if isWeekly 'active'}}" {{action "onSelectRangeType" 'weekly'}}>{{t 'common.weekly'}}</span>
        <span class="{{if isMonthly 'active'}}" {{action "onSelectRangeType" 'monthly'}}>{{t 'common.monthly'}}</span>
      </div>
      {{#if isDaily}}
        {{ca-date-picker
          showToday=true
          forMonth=forMonth
          allowDateSelectorToggle=false
          forYear=forYear
          showPreviousMonth="showPreviousMonth"
          showNextMonth="showNextMonth"
          onSelectDate="onSelectDate"
          highlightFirstDayOfMonth=false
          onSelectToday="onSelectToday"
          activities=scheduledClassActivitiesDatewise
          highlightActivities=true
        }}
      {{else if isWeekly}}
        {{ca-week-picker
          forMonth=forMonth
          forYear=forYear
          onSelectWeek="onSelectWeek"
          showPreviousMonth="showPreviousMonth"
          showNextMonth="showNextMonth"
          selectedWeekDate=selectedWeekDate
          activities=scheduledClassActivitiesDatewise
          highlightActivities=true
          }}
      {{else}}
        {{ca-month-picker
          forMonth=forMonth
          forYear=forYear
          showCalendarView=true
          onSelectMonth="onSelectMonth"
          selectedMonth=selectedMonth
        }}
      {{/if}}
    </div>
  </div>
  <div class="ca-container">
    <div class="header-container">
      <div class="activity-tab">
        <div class="schedule-icon {{unless showItemsToGrade 'active'}}" {{action "onShowClassActivities"}}>
          <span>Class Activities</span>
          {{gru-icon name="event"}}
        </div>
        <div class="items-to-grade-selector {{if showItemsToGrade 'active'}}" {{action "onShowItemsToGrade"}}>
          <span>Items to Grade ({{itemsToGrade.length}})</span>
          <i class="grading-icon"></i>
        </div>
      </div>
      {{#unless showItemsToGrade}}
        <div class="filters hidden visible-xs">
          <div class="activity-date-range-selector">
            {{#if isActive}}
              <div class="backdrop" {{action 'toggleDatePicker'}}></div>
            {{/if}}
            <div class="date-section" {{action "toggleDatePicker"}}>
              <span class="schedule-date"><span>{{format-date startDate 'DD MMM YYYY'}}</span><span class="{{if isDaily 'hidden'}}"> - {{format-date endDate 'DD MMM YYYY'}}</span></span>
              <span class="dropdown-icon">{{gru-icon name="arrow_drop_down"}}</span>
            </div>
            <div class="date-range-picker-container {{if isActive 'open'}}">
              <div class="date-range-selector">
                <span class="{{if isDaily 'active'}}" {{action "onSelectRangeType" 'daily'}}>Daily</span>
                <span class="{{if isWeekly 'active'}}" {{action "onSelectRangeType" 'weekly'}}>Weekly</span>
                <span class="{{if isMonthly 'active'}}" {{action "onSelectRangeType" 'monthly'}}>Monthly</span>
              </div>
              {{#if isDaily}}
                {{ca-date-picker
                  showToday=true
                  forMonth=forMonth
                  allowDateSelectorToggle=false
                  forYear=forYear
                  showPreviousMonth="showPreviousMonth"
                  showNextMonth="showNextMonth"
                  onSelectDate="onSelectDate"
                  highlightFirstDayOfMonth=false
                  onSelectToday="onSelectToday"
                  activities=scheduledClassActivitiesDatewise
                  highlightActivities=true
                }}
              {{else if isWeekly}}
                {{ca-week-picker
                  forMonth=forMonth
                  forYear=forYear
                  onSelectWeek="onSelectWeek"
                  showPreviousMonth="showPreviousMonth"
                  showNextMonth="showNextMonth"
                  selectedWeekDate=selectedWeekDate
                  activities=scheduledClassActivitiesDatewise
                  highlightActivities=true
                  }}
              {{else}}
                {{ca-month-picker
                  forMonth=forMonth
                  forYear=forYear
                  showCalendarView=true
                  onSelectMonth="onSelectMonth"
                  selectedMonth=selectedMonth
                }}
              {{/if}}
            </div>
          </div>
        </div>
      {{/unless}}
    </div>
    {{#if showItemsToGrade}}
      {{#if itemsToGrade}}
        <div class="items-to-grade-list">
          {{gru-grade-items
            openReportGrade='onOpenReportGrade'
            gradeableItems=itemsToGrade}}
        </div>
      {{else}}
        <div class="no-rubric-content">
          {{t 'common.all-caught-up'}}
        </div>
      {{/if}}
    {{else}}
      <div class="dca-content-list-container {{if isToday 'dca-content-list-container-today'}}">
        {{#each scheduledActivitiesList as |scheduledActivity|}}
          <div class="added-date {{if (not endDate) 'hidden'}}">{{format-date scheduledActivity.added_date 'DD MMM YYYY'}}
            <hr />
          </div>
          {{#each scheduledActivity.scheduledActivities as |activity|}}
            {{class/gru-student-class-activity-panel
             class=class
             classActivity=activity
             studentDcaReport='studentDcaReport'
             onShowSuggestion="onShowSuggestion"
             activityDate=activity.added_date
             playContent="playContent"
            }}
          {{/each}}
        {{else if (not isLoading)}}
          <p class="no-content">{{t 'ca.student.no-content'}}</p>
        {{/each}}
      </div>
    {{/if}}
  </div>
</div>

{{#if showStudentDcaReport}}
  {{reports/pull-up/dca-student-collection-report
    showPullUp=showStudentDcaReport
    reportData=studentReportContextData
    isStudent=true
    useSession=useSession
    isSuggestedCollection=isSuggestedCollection
    onClosePullUp="onClosePullUp"
  }}
{{/if}}

{{#if isShowStudentExternalCollectionReport}}
  {{reports/pull-up/dca-student-external-collection-report
    showPullUp=isShowStudentExternalCollectionReport
    reportData=studentReportContextData
    isStudent=true
    onClosePullUp="onClosePullUp"
  }}
{{/if}}

{{#if isShowStudentExternalAssessmentReport}}
  {{reports/pull-up/dca-student-external-assessment-report
    reportData=studentReportContextData
    showPullUp=isShowStudentExternalAssessmentReport
    isStudent=true
    onClosePullUp="onClosePullUp"
  }}
{{/if}}

{{#if isShowOfflineActivityReport}}
  {{reports/pull-up/oa-preview
    showPullUp=isShowOfflineActivityReport
    oaId=studentReportContextData.collection.id
    classActivity=studentReportContextData.classActivity
    isReportView=true
    classId=classId
    users=studentReportContextData.users
  }}
{{/if}}

{{#if showOAGrade}}
  {{activity/offline/grading-report
    showPullUp=showOAGrade
    context=itemToGradeContextData
    itemsToGrade=itemsToGrade
    isTeacher=false
    studentId=studentId
  }}
{{/if}}
{{#if isOpenPlayer}}
  {{reports/pull-up/player-pull-up
    showPullUp=isOpenPlayer
    playerUrl=playerUrl
    playerContent=playerContent
    onclosePullUp="closePullUp"
  }}
{{/if}}
